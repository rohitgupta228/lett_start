var priceMapper = {"1":"12","2":"12","3":"4","4":"","5":"8","6":"","7":"4","8":"8","9":"16","10":"8","11":"12","12":"12","13":"","14":"","15":"","16":"8","17":"12","18":"4"};
(function ($) {
  $(".keyword-list a").on("click", function(){
    var keyword = $(this).attr("data-search");
    var param = new URLSearchParams();
    param.append("s", keyword);
    window.location.href="search-result.html?"+param;
  })
  getData();
}(jQuery))
function getData() {
  var params = new URLSearchParams(window.location.search);
  var success = params.get('forgot');
  console.log("success ==>", success)
  if (success === 'true') {
    $("#resetModal").modal('show')
  }
  if($.API) {
    var prom = $.API.getWithoutToken('product/home');
    prom.then(function(data){
      generateHTML(data.latest, "#recent-list");
      generateHTML(data.bestSelling, "#popular-list");
      generateHTML(data.angular, "#angular-list");
      $("#explore-all-btn .btn").removeClass("d-none");
    }).catch(function(error) {
      console.log("home API error");
    }).finally(function(){
    })
  }
}
function generateHTML(data, container) {
  if (data && data.length) {
    data.forEach(function (elem) {
      var str = '';
      var img = elem.screenshot.split(".")[0];
      var type = elem.screenshot.split(".")[1];
      var smImg = elem.screenshot ? img+'-sm.'+type : 'loading.jpg'; 
      var originalPrice = priceMapper[elem.id];
      str += '<div class="col-md-6">' +
        '<div class="demo-item" id="' + elem.id + '">' +
        '<a href="theme/' + elem.detailLink + '" class="screenshot">' +
        '<img src="assets/images/slider-screenshot/' + elem.screenshot + '" srcset="assets/images/slider-screenshot/' + smImg + ' 766w, assets/images/slider-screenshot/' + elem.screenshot + ' 3000w" alt="' + elem.name + '" class="img-fluid w-100" width="714" height="456"/>' +
        '</a>' +
        '<div class="action-btn">' +
        '<a href="theme/' + elem.detailLink + '#demos" title="Live Preview" class="btn btn-primary btn-sm">Live Preview</a>' +
        '</div>' +
        '<div class="theme-desc">' +
        '<div class="title">' +
        '<h3 class="h5"><a href="theme/' + elem.detailLink + '" title="' + elem.name + '">' + elem.name + '</a></h3>' +
        '<p>'+elem.oneLinerDesc+'</p>' +
        '</div>' +
        '<div class="price">' +
        '<h4 class="font-weight-bold">$' + elem.price + '<span class="original-price">$'+ originalPrice +'</span></h4>' +
        '<a class="category" href="' + elem.catLink + '">' + elem.mainCat + '</a>' +
        '</div>' +
        '</div>' +
        '</div>' +
        '</div>';
      var item = $.parseHTML(str);
      if (elem.category && elem.category.indexOf("angular") > -1) {
        $(item).find(".screenshot").append("<div class='icon'><i class='bx bxl-angular'></i></div>")
      }
      $(container).append(item);
    });
  }
}