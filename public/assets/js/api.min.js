var baseURL = "https://lettstartdesign.com/laravel-backend/api/";
!function ($) {
  var API = function () { }
  API.prototype.get = function (endPoint, payload) {
    var token = localStorage.getItem("token");
    return new Promise(function (resolve, reject) {
      if (token && token !== "") {
        $.ajax({
          type: "GET",
          url: baseURL + endPoint,
          headers: {
            'authorization': 'Bearer ' + localStorage.getItem("token")
          },   
          success: function (resp) {
            if(resp.hasOwnProperty('data')) {
              resolve(resp.data);  
              return;
            }
            resolve(resp)
          },
          error: function (error) {
            reject(error)
          },
          complete: function () {
            console.log("get completed")
          }
        });
      }
      else {
        reject({noToken: true})
      }
    })
  }
  API.prototype.profilePic = function (endPoint, payload) {
    var token = localStorage.getItem("token");
    return new Promise(function (resolve, reject) {
      if (token && token !== "") {
        $.ajax({
          type: "POST",
          url: baseURL + endPoint,
          processData: false,
          contentType: false,
          headers: {
            'authorization': 'Bearer ' + localStorage.getItem("token")
          },
          data: payload,
          success: function (resp) {
            if(resp.hasOwnProperty('data')) {
              resolve(resp.data);  
              return;
            }
            resolve(resp)
          },
          error: function (error) {
            resolve(error);
          },
          complete: function () {
            console.log("post completed")
          }
        });
      }
      else {
        reject("invalid token")
      }
    })
  } //init App
  API.prototype.post = function (endPoint, payload) {
    var token = localStorage.getItem("token");
    return new Promise(function (resolve, reject) {
      if (token && token !== "") {
        $.ajax({
          type: "POST",
          dataType:"json",
          url: baseURL + endPoint,
          contentType:"application/json",
          headers: {
            'authorization': 'Bearer ' + localStorage.getItem("token")
          },
          data: JSON.stringify(payload),
          success: function (resp) {
            if(resp.hasOwnProperty('data')) {
              resolve(resp.data);  
              return;
            }
            resolve(resp)
          },
          error: function (error) {
            resolve(error);
          },
          complete: function () {
            console.log("post completed")
          }
        });
      }
      else {
        reject({noToken: true})
      }
    })
  } //init App
  API.prototype.getWithoutToken = function (endPoint, payload) {
    return new Promise(function (resolve, reject) {
      $.ajax({
        type: "GET",
        url: baseURL + endPoint,
        success: function (resp) {
          if(resp.hasOwnProperty('data')) {
            resolve(resp.data);  
            return;
          }
          resolve(resp)
        },
        error: function (error) {
          reject(error)
        },
        complete: function () {
          console.log("get without token completed")
        }
      });
    })
  }
  API.prototype.postWithoutToken = function (endPoint, payload) {
    return new Promise(function (resolve, reject) {
      $.ajax({
        type: "POST",
        dataType:"json",
        url: baseURL + endPoint,
        contentType:"application/json",
        data: JSON.stringify(payload),
        success: function (resp) {
          if(resp.hasOwnProperty('data')) {
            resolve(resp.data);  
            return;
          }
          resolve(resp)
        },
        error: function (error) {
          resolve(error);
        },
        complete: function () {
          console.log("post wihtout token completed")
        }
      });
    })
  } //init App
  $.API = new API, $.API.Constructor = API
}(window.jQuery)